@model Nop.Plugin.Widgets.GoogleAnalytics.Models.PublicInfoModel
@Html.Raw(Model.TrackingScript)
@if (Model.AddCookieConsentChangedScriptsToFooter)
{
<script asp-location="Footer">
    $(document).ready(function () {
        $(window).on('cookieConsentChanged', function () {
            $.ajax({
                cache: false,
                type: "GET",
                url: "@Url.Action("GetConsentStatus", "WidgetsGoogleAnalytics")",
                dataType: "json",
                success: function (data, textStatus, jqXHR) {
                    gtag('consent', 'update', data);
                    if (data.ad_storage == 'consent') {
                        gtag("set", "ads_data_redaction", false);
                    } else {
                        gtag("set", "ads_data_redaction", true);
                    }
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    alert('Cannot get value');
                }
            });
        });
    });
</script>
}